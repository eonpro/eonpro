# ============================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ============================================
# CRITICAL: Update all values before deployment

# ===========================================
# DATABASE CONFIGURATION
# ===========================================
# PostgreSQL connection string
DATABASE_URL="postgresql://USER:PASSWORD@HOST:5432/lifefile_prod?schema=public&sslmode=require"

# Connection pool settings
DATABASE_CONNECTION_LIMIT=10
DATABASE_POOL_TIMEOUT=10

# ===========================================
# SECURITY & ENCRYPTION
# ===========================================
# Generate new keys for production:
# openssl rand -hex 32
ENCRYPTION_KEY="REPLACE_WITH_PRODUCTION_KEY_64_HEX_CHARS"

# Generate secure JWT secrets:
# openssl rand -base64 32
JWT_SECRET="REPLACE_WITH_PRODUCTION_JWT_SECRET_MIN_32_CHARS"
JWT_REFRESH_SECRET="REPLACE_WITH_PRODUCTION_REFRESH_SECRET"
NEXTAUTH_SECRET="REPLACE_WITH_PRODUCTION_NEXTAUTH_SECRET"

# Token configuration
TOKEN_VERSION=1

# ===========================================
# SESSION CONFIGURATION
# ===========================================
# HIPAA-compliant session timeouts (in milliseconds)
SESSION_TIMEOUT=900000           # 15 minutes idle timeout
SESSION_IDLE_TIMEOUT=900000      # 15 minutes inactivity
ABSOLUTE_SESSION_TIMEOUT=28800000 # 8 hours max session

# ===========================================
# STORAGE CONFIGURATION
# ===========================================
# Private storage for PHI documents
PRIVATE_STORAGE_PATH=/var/app/private-storage

# AWS S3 configuration (optional, for document storage)
# AWS_ACCESS_KEY_ID="your_access_key"
# AWS_SECRET_ACCESS_KEY="your_secret_key"
# AWS_REGION="us-east-1"
# AWS_S3_BUCKET="lifefile-documents-prod"
# AWS_S3_ENCRYPTION="AES256"

# ===========================================
# APPLICATION SETTINGS
# ===========================================
# Production URLs
NEXTAUTH_URL=https://app.lifefile.com
NEXT_PUBLIC_APP_URL=https://app.lifefile.com

# Environment
NODE_ENV=production

# ===========================================
# CLINIC CONFIGURATION
# ===========================================
DEFAULT_CLINIC_ID=1
BYPASS_CLINIC_FILTER=false
MULTI_TENANT_MODE=true

# ===========================================
# AUDIT & COMPLIANCE
# ===========================================
# HIPAA requires 6 years retention
AUDIT_LOG_RETENTION_DAYS=2190
AUDIT_LOG_LEVEL=info
ENABLE_AUDIT_LOG=true
AUDIT_LOG_DESTINATION=database

# Compliance settings
HIPAA_COMPLIANCE_MODE=true
REQUIRE_ENCRYPTION=true
REQUIRE_MFA=false  # Set to true when MFA is implemented

# ===========================================
# SECURITY CONFIGURATION
# ===========================================
ENABLE_SECURITY_HEADERS=true
ENABLE_RATE_LIMITING=true
MAX_LOGIN_ATTEMPTS=3
LOCKOUT_DURATION_MINUTES=30

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=https://app.lifefile.com/api/csp-report

# CORS settings
CORS_ALLOWED_ORIGINS=https://app.lifefile.com,https://www.lifefile.com
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_ALLOWED_HEADERS=Content-Type,Authorization

# ===========================================
# EMAIL CONFIGURATION
# ===========================================
# SendGrid, AWS SES, or SMTP
EMAIL_PROVIDER=sendgrid
SENDGRID_API_KEY="REPLACE_WITH_SENDGRID_API_KEY"
EMAIL_FROM=noreply@lifefile.com
EMAIL_FROM_NAME="Lifefile Health"

# ===========================================
# PAYMENT PROCESSING
# ===========================================
# Stripe configuration
STRIPE_SECRET_KEY="REPLACE_WITH_STRIPE_PRODUCTION_SECRET"
STRIPE_WEBHOOK_SECRET="REPLACE_WITH_STRIPE_WEBHOOK_SECRET"
STRIPE_PUBLIC_KEY="REPLACE_WITH_STRIPE_PUBLIC_KEY"

# ===========================================
# THIRD-PARTY INTEGRATIONS
# ===========================================
# OpenAI for SOAP notes (ensure PHI is anonymized)
OPENAI_API_KEY="REPLACE_WITH_OPENAI_API_KEY"
OPENAI_ORGANIZATION="REPLACE_WITH_ORG_ID"

# Heyflow integration
HEYFLOW_API_KEY="REPLACE_WITH_HEYFLOW_KEY"
HEYFLOW_WEBHOOK_SECRET="REPLACE_WITH_HEYFLOW_SECRET"

# ===========================================
# MONITORING & LOGGING
# ===========================================
# Sentry for error tracking (no PHI in errors!)
SENTRY_DSN="REPLACE_WITH_SENTRY_DSN"
SENTRY_ENVIRONMENT=production
SENTRY_SAMPLE_RATE=1.0

# DataDog or New Relic
DATADOG_API_KEY="REPLACE_WITH_DATADOG_KEY"
DATADOG_APP_KEY="REPLACE_WITH_DATADOG_APP_KEY"

# ===========================================
# PERFORMANCE & CACHING
# ===========================================
# Redis configuration (for sessions, caching, rate limiting)
REDIS_URL="redis://:PASSWORD@HOST:6379"
REDIS_TLS_ENABLED=true
CACHE_TTL=3600  # 1 hour default cache

# ===========================================
# BACKUP & DISASTER RECOVERY
# ===========================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_ENCRYPTION=true
BACKUP_S3_BUCKET="lifefile-backups-prod"

# ===========================================
# FEATURE FLAGS
# ===========================================
ENABLE_TELEMETRY=true
ENABLE_BETA_FEATURES=false
MAINTENANCE_MODE=false
READ_ONLY_MODE=false

# ===========================================
# RATE LIMITING
# ===========================================
# API rate limits (requests per minute)
RATE_LIMIT_API=100
RATE_LIMIT_AUTH=10
RATE_LIMIT_WEBHOOK=50

# ===========================================
# DEVELOPMENT & DEBUG
# ===========================================
# NEVER enable in production!
DEBUG=false
VERBOSE_LOGGING=false
SQL_LOGGING=false
