# HIPAA-Compliant Security Configuration
# Copy this file to .env.local and update with your values
# Generate secure values with the commands shown below

# CRITICAL: Encryption Key for PHI (32 bytes hex)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=REPLACE_WITH_32_BYTE_HEX_STRING

# CRITICAL: JWT Secrets (minimum 32 characters)
# Generate with: openssl rand -base64 32
JWT_SECRET=REPLACE_WITH_SECURE_RANDOM_VALUE_MIN_32_CHARS
JWT_REFRESH_SECRET=REPLACE_WITH_SECURE_RANDOM_VALUE
NEXTAUTH_SECRET=REPLACE_WITH_SECURE_RANDOM_VALUE

# Token Configuration
TOKEN_VERSION=1

# Session Configuration (milliseconds)
SESSION_TIMEOUT=900000           # 15 minutes
SESSION_IDLE_TIMEOUT=900000      # 15 minutes  
ABSOLUTE_SESSION_TIMEOUT=28800000 # 8 hours

# Private Storage Path
PRIVATE_STORAGE_PATH=./private-storage

# Database URL (update with your actual database)
# For development with SQLite:
DATABASE_URL="file:./prisma/dev.db"

# For production PostgreSQL with connection pooling:
# DATABASE_URL="postgresql://user:pass@pooler-host:6543/db?pgbouncer=true&connection_limit=1"
# DIRECT_DATABASE_URL="postgresql://user:pass@direct-host:5432/db"
#
# IMPORTANT: DIRECT_DATABASE_URL is REQUIRED for:
# - Prisma migrations (prisma migrate deploy)
# - Schema introspection (prisma db pull)
# - CI/CD pipelines
# Must be a direct connection (not pooled) typically on port 5432

# Application URLs
NEXTAUTH_URL=http://localhost:3000
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Environment
NODE_ENV=development

# Clinic Configuration
DEFAULT_CLINIC_ID=1
BYPASS_CLINIC_FILTER=false

# Audit Configuration
AUDIT_LOG_RETENTION_DAYS=2190  # 6 years for HIPAA
AUDIT_LOG_LEVEL=info

# Security Configuration
ENABLE_SECURITY_HEADERS=true
ENABLE_RATE_LIMITING=true
MAX_LOGIN_ATTEMPTS=3
LOCKOUT_DURATION_MINUTES=30

# OpenAI Configuration (if using AI features)
# OPENAI_API_KEY=your_openai_api_key_here

# ===========================================
# AWS SES Email Configuration
# ===========================================
# Enable the SES email feature flag
NEXT_PUBLIC_ENABLE_AWS_SES_EMAIL=true

# AWS Credentials (required for SES)
# Use IAM credentials with SES permissions
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key

# SES Region (must match your verified domain region)
AWS_SES_REGION=us-east-1

# Sender Configuration
# Email must be verified in SES (or domain must be verified)
AWS_SES_FROM_EMAIL=noreply@yourdomain.com
AWS_SES_FROM_NAME=Lifefile Health

# Optional: Reply-to address
AWS_SES_REPLY_TO_EMAIL=support@yourdomain.com

# Optional: SES Configuration Set (for tracking)
# AWS_SES_CONFIGURATION_SET=lifefile-emails

# Optional: Max send rate (emails per second, default: 14)
# AWS_SES_MAX_SEND_RATE=14

# ===========================================
# Legacy SMTP Configuration (deprecated)
# Use AWS SES instead
# ===========================================
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your_email@gmail.com
# SMTP_PASS=your_app_password

# Stripe Configuration (for payments)
# STRIPE_SECRET_KEY=your_stripe_secret_key
# STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret

# SMS Service (for 2FA)
# TWILIO_ACCOUNT_SID=your_twilio_sid
# TWILIO_AUTH_TOKEN=your_twilio_token
# TWILIO_PHONE_NUMBER=+1234567890

# Dead Letter Queue (Upstash Redis)
# Used for reliable webhook delivery with automatic retries
# UPSTASH_REDIS_REST_URL=https://your-instance.upstash.io
# UPSTASH_REDIS_REST_TOKEN=your_rest_token

# Cron Job Security
# Generate with: openssl rand -hex 16
# CRON_SECRET=your_cron_secret

# Alerting (for DLQ exhaustion alerts)
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
# ALERT_EMAIL=admin@eonmeds.com
